
Findings:

  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/assets/scaffold/files/upgrade.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        923â”† @unlink($path);
          â‹®â”†----------------------------------------
        966â”† if (!@unlink($path)) {
          â‹®â”†----------------------------------------
        979â”† if (!@unlink($dirpath)) {


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/AssetBundle/Entity/Asset.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        726â”† unlink($filePath);
          â‹®â”†----------------------------------------
        771â”† unlink($file);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/AssetBundle/Entity/AssetRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'assets')             ->set('download_count',
        'download_count + '.(int) $increaseBy)` Detected string concatenation with a non-literal
        variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the variable
        is user-controlled and not properly sanitized. In order to prevent SQL injection, used
        parameterized queries or prepared statements instead.

        193â”† ->where('id = '.(int) $id);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/AssetBundle/Entity/DownloadRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->select('u.is_unique')` Detected string concatenation with a non-literal variable in a
        Doctrine QueryBuilder method. This could lead to SQL injection if the variable is user-
        controlled and not properly sanitized. In order to prevent SQL injection, used parameterized
        queries or prepared statements instead.

         41â”† ->from(sprintf('(SELECT (NOT EXISTS (%s)) is_unique)', $q2->getSQL()), 'u'
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'asset_downloads')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        260â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/AssetBundle/Tests/Asset/AbstractAssetTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         48â”† unlink($this->csvPath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/AssetBundle/Tests/Controller/Api/AssetApiControllerFunctionalTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         46â”† unlink($assetsPath.'/file.txt');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CampaignBundle/Entity/CampaignRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'campaign_events')             ->set('parent_id', ':null')
        ->setParameter('null', null)` Detected string concatenation with a non-literal variable in a
        Doctrine QueryBuilder method. This could lead to SQL injection if the variable is user-
        controlled and not properly sanitized. In order to prevent SQL injection, used parameterized
        queries or prepared statements instead.

         52â”† ->where('campaign_id = '.$entity->getId())
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->delete(MAUTIC_TABLE_PREFIX.'campaign_events')` Detected string concatenation with a
        non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if
        the variable is user-controlled and not properly sanitized. In order to prevent SQL
        injection, used parameterized queries or prepared statements instead.

         58â”† ->where('campaign_id = '.$entity->getId())
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        368â”† sprintf('NOT EXISTS (%s)', $sq->getSQL())
          â‹®â”†----------------------------------------
        418â”† sprintf('NOT EXISTS (%s)', $sq->getSQL())
          â‹®â”†----------------------------------------
        494â”† sprintf('NOT EXISTS (%s)', $sq->getSQL())
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->from(MAUTIC_TABLE_PREFIX.'campaigns', 'c')             ->leftJoin('c',
        MAUTIC_TABLE_PREFIX.'campaign_leads', 'cl', 'cl.campaign_id = c.id AND cl.manually_removed =
        0')` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        579â”† '(SELECT lll.lead_id AS ll, lll.lead_id FROM '.MAUTIC_TABLE_PREFIX.'lead_lists_leads lll WHERE lll.leadlist_id = '.$segmentId
        580â”† .' AND lll.manually_removed = 0)',


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CampaignBundle/Entity/LeadEventLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        610â”† $stmt       = $connection->prepare($sql);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$expr` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        274â”† sprintf('NOT EXISTS (%s)', $failedSq->getSQL())
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'campaign_lead_event_log')             ->set('lead_id',
        (int) $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        343â”† ->where('lead_id = '.(int) $fromLeadId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->_em->getConnection()->createQueryBuilder()
        ->delete(MAUTIC_TABLE_PREFIX.'campaign_lead_event_log')` Detected string concatenation with
        a non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection
        if the variable is user-controlled and not properly sanitized. In order to prevent SQL
        injection, used parameterized queries or prepared statements instead.

        353â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CampaignBundle/Entity/LeadRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         88â”† $q->andWhere('l.id NOT IN('.$dq->getDQL().')')
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'campaign_leads')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        118â”† ->where('lead_id = '.(int) $fromLeadId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->getEntityManager()->getConnection()->createQueryBuilder()
        ->delete(MAUTIC_TABLE_PREFIX.'campaign_leads')` Detected string concatenation with a non-
        literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the
        variable is user-controlled and not properly sanitized. In order to prevent SQL injection,
        used parameterized queries or prepared statements instead.

        128â”† ->where('lead_id = '.(int) $fromLeadId)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        209â”† sprintf('NOT EXISTS (%s)', $eventQb->getSQL())
          â‹®â”†----------------------------------------
        225â”† sprintf('EXISTS (%s)', $grandparentQb->getSQL())
          â‹®â”†----------------------------------------
        239â”† sprintf('NOT EXISTS (%s)', $anyEventQb->getSQL())
          â‹®â”†----------------------------------------
        302â”† sprintf('NOT EXISTS (%s)', $eventQb->getSQL())


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CampaignBundle/Tests/Functional/Entity/LeadEventLogRepositoryTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         21â”†  ... $connection->prepare('INSERT INTO `'.MAUTIC_TABLE_PREFIX.'campaign_lead_event_log` (`event_id`, `lead_id`, `rotation`, `is_scheduled`, `system_triggered`) VALUE ... [0m
          [shortened a long line from output, adjust with --max-chars-per-line]


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/ConfigBundle/Controller/SysinfoController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.assert-use-audit
        Calling assert with user input is equivalent to eval'ing.

         22â”† assert($model instanceof SysinfoModel);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/ConfigBundle/Event/ConfigEvent.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        172â”† @unlink($tmpFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/ConfigBundle/Model/SysinfoModel.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.phpinfo-use
        The 'phpinfo' function may reveal sensitive information about your environment.

         62â”† phpinfo(INFO_GENERAL | INFO_CONFIGURATION | INFO_MODULES);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/ConfigBundle/Tests/Controller/ConfigControllerFunctionalTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         50â”† unlink($this->getConfigPath());


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Cache/MiddlewareCacheWarmer.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         59â”† unlink($this->cacheFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Command/ConvertConfigCommand.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        104â”† if (!unlink($configPath)) {


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Command/GenerateProductionAssetsCommand.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         63â”† unlink($this->pathsHelper->getSystemPath('assets', true).'/js/mautic-form-tmp.js');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Command/MaxMindDoNotSellPurgeCommand.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        131â”† $stmt = $conn->prepare($sql);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Command/ModeratedCommand.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        130â”† @unlink($this->lockFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Controller/AjaxController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        565â”† @unlink($file->getPath().'/'.$file->getFilename());
          â‹®â”†----------------------------------------
        577â”† @unlink($cacheDir.'/lastUpdateCheck.txt');
          â‹®â”†----------------------------------------
        581â”† @unlink($cacheDir.'/'.MAUTIC_VERSION.'.zip');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Controller/Api/FileApiController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        121â”† unlink($filePath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Controller/FileController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        100â”† unlink($imagePath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Entity/AuditLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb             ->select('ip.date_added, ip.ip_address, ip.lead_id, ip.id')` Detected
        string concatenation with a non-literal variable in a Doctrine QueryBuilder method. This
        could lead to SQL injection if the variable is user-controlled and not properly sanitized.
        In order to prevent SQL injection, used parameterized queries or prepared statements
        instead.

        235â”† ->from(sprintf('(%s)', $sqb->getSQL()), 'ip');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Entity/NotificationRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb->update(MAUTIC_TABLE_PREFIX.'notifications')                 ->set('is_read', 1)`
        Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         71â”† ->where('user_id = '.(int) $userId.' AND is_read = 0')


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Helper/AssetGenerationHelper.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        132â”† unlink($assetFile);
          â‹®â”†----------------------------------------
        171â”† unlink($inProgressFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Helper/Chart/ChartQuery.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$uniqueQuery` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        461â”† $uniqueQuery->select('COUNT('.$tablePrefix.'.'.$uniqueColumn.') AS count')
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$uniqueQuery->select('COUNT('.$tablePrefix.'.'.$uniqueColumn.') AS count')` Detected string
        concatenation with a non-literal variable in a Doctrine QueryBuilder method. This could lead
        to SQL injection if the variable is user-controlled and not properly sanitized. In order to
        prevent SQL injection, used parameterized queries or prepared statements instead.

        462â”† ->from('('.$query->getSql().')', $tablePrefix);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Helper/LanguageHelper.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        132â”† @unlink($packagePath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Helper/Serializer.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

         26â”† return unserialize($serializedString);
          â‹®â”†----------------------------------------
         29â”† return unserialize($serializedString, $options);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Helper/ThemeHelper.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        407â”† unlink($zipFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/IpLookup/AbstractLocalDataLookup.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        107â”† @unlink($temporaryPhar);
          â‹®â”†----------------------------------------
        128â”† @unlink($tempTarget);
          â‹®â”†----------------------------------------
        143â”† @unlink($tempTarget);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Test/MauticMysqlTestCase.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        235â”† unlink($sqlDumpFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Tests/Functional/Controller/FileControllerTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         67â”† unlink($this->uploadedFilePath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Tests/Functional/Doctrine/Paginator/SimplePaginatorTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.assert-use-audit
        Calling assert with user input is equivalent to eval'ing.

         29â”† assert($logger instanceof DebugStack);
          â‹®â”†----------------------------------------
         48â”† assert($repository instanceof IpAddressRepository);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Tests/Unit/Command/ModeratedCommandTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        225â”† unlink($file->getPathname());


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Tests/Unit/Helper/LanguageHelperTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        115â”† @unlink($langFile);
          â‹®â”†----------------------------------------
        136â”† @unlink($langFile);
          â‹®â”†----------------------------------------
        140â”† @unlink($this->tmpPath.'/es.zip');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Tests/Unit/Helper/MaxMindDoNotSellDownloadHelperTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         50â”† unlink($filename);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Tests/Unit/Helper/UpdateHelperTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        104â”† @unlink(__DIR__.'/resource/update/tmp/lastUpdateCheck.txt');
          â‹®â”†----------------------------------------
        128â”† @unlink($updatePackage);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Tests/Unit/IpLookup/MaxMindDoNotSellListTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         47â”† unlink($this->goodFilePath);
          â‹®â”†----------------------------------------
         51â”† unlink($this->badFilePath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Update/Step/FinalizeUpdateStep.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         59â”† @unlink($this->pathsHelper->getRootPath().'/upgrade.php');
          â‹®â”†----------------------------------------
         60â”† @unlink($this->pathsHelper->getCachePath().'/lastUpdateCheck.txt');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Update/Step/InstallNewFilesStep.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         87â”† @unlink($zipFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/CoreBundle/Update/Step/RemoveDeletedFilesStep.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         65â”† @unlink($this->appRoot.'/deleted_files.txt');
          â‹®â”†----------------------------------------
         79â”† if (@unlink($path)) {


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/DashboardBundle/Controller/DashboardController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        389â”† unlink($path);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/DynamicContentBundle/Entity/DynamicContentRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'dynamic_content')             ->set('sent_count',
        'sent_count + '.(int) $increaseBy)` Detected string concatenation with a non-literal
        variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the variable
        is user-controlled and not properly sanitized. In order to prevent SQL injection, used
        parameterized queries or prepared statements instead.

        133â”† ->where('id = '.(int) $id);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/DynamicContentBundle/Entity/StatRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        131â”† $query->expr()->like('dc.name', $query->expr()->literal('%'.$options['search'].'%'))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'dynamic_content_stats')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        149â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/EmailBundle/Command/ProcessEmailQueueCommand.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        143â”† unlink($tmpFilename);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

        117â”† $message = unserialize(file_get_contents($tmpFilename));


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/EmailBundle/Entity/EmailRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->getEntityManager()->getConnection()->createQueryBuilder()
        ->select('el.leadlist_id')                 ->from(MAUTIC_TABLE_PREFIX.'email_list_xref',
        'el')` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        206â”† ->where('el.email_id = '.(int) $emailId)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$segmentQb->select('ll.lead_id')             ->from(MAUTIC_TABLE_PREFIX.'lead_lists_leads',
        'll')` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        225â”† $segmentQb->expr()->andX(
        226â”†     $segmentQb->expr()->in('ll.leadlist_id', $listIds),
        227â”†     $segmentQb->expr()->eq('ll.manually_removed', ':false')
        228â”† )
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->from(MAUTIC_TABLE_PREFIX.'leads', 'l')` Detected string concatenation with a non-
        literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the
        variable is user-controlled and not properly sanitized. In order to prevent SQL injection,
        used parameterized queries or prepared statements instead.

        248â”† ->andWhere(sprintf('l.id IN (%s)', $segmentQb->getSQL()))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->from(MAUTIC_TABLE_PREFIX.'leads', 'l')             ->andWhere(sprintf('l.id IN (%s)',
        $segmentQb->getSQL()))` Detected string concatenation with a non-literal variable in a
        Doctrine QueryBuilder method. This could lead to SQL injection if the variable is user-
        controlled and not properly sanitized. In order to prevent SQL injection, used parameterized
        queries or prepared statements instead.

        249â”† ->andWhere(sprintf('l.id NOT IN (%s)', $dncQb->getSQL()))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->from(MAUTIC_TABLE_PREFIX.'leads', 'l')             ->andWhere(sprintf('l.id IN (%s)',
        $segmentQb->getSQL()))             ->andWhere(sprintf('l.id NOT IN (%s)',
        $dncQb->getSQL()))` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        250â”† ->andWhere(sprintf('l.id NOT IN (%s)', $statQb->getSQL()))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->from(MAUTIC_TABLE_PREFIX.'leads', 'l')             ->andWhere(sprintf('l.id IN (%s)',
        $segmentQb->getSQL()))             ->andWhere(sprintf('l.id NOT IN (%s)', $dncQb->getSQL()))
        ->andWhere(sprintf('l.id NOT IN (%s)', $statQb->getSQL()))` Detected string concatenation
        with a non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL
        injection if the variable is user-controlled and not properly sanitized. In order to prevent
        SQL injection, used parameterized queries or prepared statements instead.

        251â”† ->andWhere(sprintf('l.id NOT IN (%s)', $mqQb->getSQL()))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        256â”† $q->andWhere(sprintf('l.id NOT IN (%s)', $unsubscribeLeadsQb->getSQL()));
          â‹®â”†----------------------------------------
        539â”† $q->where('id = '.(int) $id);
          â‹®â”†----------------------------------------
        542â”† $q->set('variant_'.$type.'_count', 'variant_'.$type.'_count + '.(int) $increaseBy);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/EmailBundle/Entity/StatRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        151â”† $q->expr()->orX(
        152â”†     $q->expr()->eq('s.list_id', ':segmentId'),
        153â”†     $q->expr()->andX(
        154â”†         $q->expr()->isNull('s.list_id'),
        155â”†         sprintf('EXISTS (%s)', $sb->getSQL())
        156â”†     )
        157â”† )
          â‹®â”†----------------------------------------
        294â”† $q->andWhere(sprintf('EXISTS (%s)', $subQ->getSQL()));
          â‹®â”†----------------------------------------
        410â”† $q->andWhere('s.list_id = '.(int) $listId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        466â”† $query->expr()->orX(
        467â”†     $query->expr()->like('ec.subject', $query->expr()->literal('%'.$options['search'].'%')),
        468â”†     $query->expr()->like('e.subject', $query->expr()->literal('%'.$options['search'].'%')),
        469â”†     $query->expr()->like('e.name', $query->expr()->literal('%'.$options['search'].'%'))
        470â”† )
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'email_stats')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        593â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/EmailBundle/EventListener/ReportSubscriber.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        356â”† $qb->leftJoin(self::EMAILS_PREFIX, sprintf('(%s)', $qbcut->getSQL()), self::CLICK_PREFIX, 'e.id = cut.channel_id');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/EmailBundle/Stats/Helper/FilterTrait.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         34â”† sprintf('EXISTS (%s)', $sb->getSql())
          â‹®â”†----------------------------------------
         83â”† sprintf('EXISTS (%s)', $sb->getSql())


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/EmailBundle/Tests/Swiftmailer/Spool/DelegatingSpoolTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         63â”† unlink($messageFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/FormBundle/Entity/FormRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        178â”† $query->andWhere('fs.lead_id = '.(int) $options['leadId']);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/FormBundle/Entity/SubmissionRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$fq->select('f.id, f.label, f.alias, f.type')
        ->from(MAUTIC_TABLE_PREFIX.'form_fields', 'f')` Detected string concatenation with a non-
        literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the
        variable is user-controlled and not properly sanitized. In order to prevent SQL injection,
        used parameterized queries or prepared statements instead.

         58â”† ->where('f.form_id = '.$form->getId())
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$dq->select('count(r.submission_id) as count')
        ->from($this->getResultsTableName($form->getId(), $form->getAlias()), 'r')
        ->innerJoin('r', MAUTIC_TABLE_PREFIX.'form_submissions', 's', 'r.submission_id = s.id')
        ->leftJoin('s', MAUTIC_TABLE_PREFIX.'ip_addresses', 'i', 's.ip_id = i.id')` Detected string
        concatenation with a non-literal variable in a Doctrine QueryBuilder method. This could lead
        to SQL injection if the variable is user-controlled and not properly sanitized. In order to
        prevent SQL injection, used parameterized queries or prepared statements instead.

         79â”† ->where('r.form_id = '.$form->getId());
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$dq` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         93â”† $dq->select('r.submission_id, s.date_submitted as dateSubmitted, s.lead_id as leadId, s.referer, i.ip_address as ipAddress'.$fieldAliasSql);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        139â”† $q->select('s, p, i,'.$leadSelect.','.$order)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        286â”† $query->andWhere('fs.lead_id = '.(int) $options['leadId']);
          â‹®â”†----------------------------------------
        296â”† $query->expr()->like('f.name', $query->expr()->literal('%'.$options['search'].'%'))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'form_submissions')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        421â”† ->where('lead_id = '.(int) $fromLeadId)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        503â”† $q->andWhere($q->expr()->$operatorExpr('r.'.$field, $value));
          â‹®â”†----------------------------------------
        506â”† $q->andWhere($q->expr()->$operatorExpr('r.'.$field, ':value'))


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/InstallBundle/Tests/Functional/InstallWorkflowTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         44â”† unlink($this->localConfigPath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/IntegrationsBundle/Entity/ObjectMappingRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        240â”† $result = $connection->executeQuery($qb->getSQL().$lock, $qb->getParameters(), $qb->getParameterTypes())->fetchAssociative();


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/IntegrationsBundle/Migration/AbstractMigration.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         57â”† $stmt = $connection->prepare($sql);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Controller/Api/CustomFieldsApiControllerTrait.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

         92â”† $properties = is_string($fieldDefinition['properties']) ? unserialize($fieldDefinition['properties']) : $fieldDefinition['properties'];


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Controller/FrequencyRuleTrait.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.assert-use-audit
        Calling assert with user input is equivalent to eval'ing.

         56â”† assert($emailModel instanceof EmailModel);
          â‹®â”†----------------------------------------
        165â”† assert($dncModel instanceof \Mautic\LeadBundle\Model\DoNotContact);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Controller/ImportController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        323â”† unlink($fullPath);
          â‹®â”†----------------------------------------
        630â”† unlink($filepath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Controller/LeadController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.assert-use-audit
        Calling assert with user input is equivalent to eval'ing.

        157â”† assert($leadListModel instanceof ListModel);
          â‹®â”†----------------------------------------
        181â”† assert($leadDNCModel instanceof \Mautic\LeadBundle\Model\DoNotContact);
          â‹®â”†----------------------------------------
        350â”† assert($companyModel instanceof CompanyModel);
          â‹®â”†----------------------------------------
        377â”† assert($model instanceof ListModel);
          â‹®â”†----------------------------------------
        380â”† assert($leadNoteModel instanceof NoteModel);
          â‹®â”†----------------------------------------
        446â”† assert($leadFieldModel instanceof FieldModel);
          â‹®â”†----------------------------------------
        655â”† assert($leadFieldModel instanceof FieldModel);
          â‹®â”†----------------------------------------
       1091â”† assert($model instanceof LeadModel);
          â‹®â”†----------------------------------------
       1157â”† assert($model instanceof LeadModel);
          â‹®â”†----------------------------------------
       1272â”† assert($companyModel instanceof CompanyModel);
          â‹®â”†----------------------------------------
       1909â”† assert($userModel instanceof UserModel);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/DoNotContactRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         93â”† $q->innerJoin('dnc', sprintf('(%s)', $subQ->getSQL()), 'cs', 'cs.lead_id = dnc.lead_id');
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        134â”† $query->expr()->like('dnc.channel', $query->expr()->literal('%'.$options['search'].'%'))


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/FrequencyRuleRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        153â”† '(ch.'.$statSentColumn.' >= case fr.frequency_time
        154â”†      when \'MONTH\' then DATE_SUB(NOW(),INTERVAL 1 MONTH)
        155â”†      when \'DAY\' then DATE_SUB(NOW(),INTERVAL 1 DAY)
        156â”†      when \'WEEK\' then DATE_SUB(NOW(),INTERVAL 1 WEEK)
        157â”†     end)'
          â‹®â”†----------------------------------------
        207â”† $q->andWhere('ch.'.$statSentColumn.' >= :frequencyTime')
          â‹®â”†----------------------------------------
        221â”† sprintf('NOT EXISTS (%s)', $subQuery->getSQL())


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/Import.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        347â”† unlink($file);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/LeadDeviceRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$sq` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         59â”† $sq->expr()->eq('es.device', ':device'.$key)
          â‹®â”†----------------------------------------
         71â”† $sq->expr()->eq('es.device_brand', ':deviceBrand'.$key)
          â‹®â”†----------------------------------------
         83â”† $sq->expr()->eq('es.device_model', ':deviceModel'.$key)
          â‹®â”†----------------------------------------
         95â”† $sq->expr()->eq('es.device_os_name', ':deviceOs'.$key)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'lead_devices')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        181â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/LeadEventLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'lead_event_log')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        139â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/LeadListRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$subExpr` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        396â”† $subQb->expr()->in(sprintf('%s.%s', $alias, $column), ":$subFilterParamter")
          â‹®â”†----------------------------------------
        404â”† $subQb->expr()->$subFunc(sprintf('%s.%s', $alias, $column), ":$subFilterParamter")


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/LeadRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$fq->select('l.*')             ->from(MAUTIC_TABLE_PREFIX.'leads', 'l')` Detected string
        concatenation with a non-literal variable in a Doctrine QueryBuilder method. This could lead
        to SQL injection if the variable is user-controlled and not properly sanitized. In order to
        prevent SQL injection, used parameterized queries or prepared statements instead.

        361â”† ->where('l.id = '.$id);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb->select('count(*)')` Detected string concatenation with a non-literal variable in a
        Doctrine QueryBuilder method. This could lead to SQL injection if the variable is user-
        controlled and not properly sanitized. In order to prevent SQL injection, used parameterized
        queries or prepared statements instead.

       1233â”† $qb->select('count(*)')->from(sprintf('(%s)', $sql), 'sub');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/ListLeadRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'lead_lists_leads')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         35â”† ->where('lead_id = '.(int) $fromLeadId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->_em->getConnection()->createQueryBuilder()
        ->delete(MAUTIC_TABLE_PREFIX.'lead_lists_leads')` Detected string concatenation with a non-
        literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the
        variable is user-controlled and not properly sanitized. In order to prevent SQL injection,
        used parameterized queries or prepared statements instead.

         45â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/PointsChangeLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'lead_points_change_log')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         85â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/StagesChangeLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'lead_stages_change_log')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         52â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Entity/TagRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb->select('t.id')             ->from(MAUTIC_TABLE_PREFIX.'lead_tags', 't')` Detected
        string concatenation with a non-literal variable in a Doctrine QueryBuilder method. This
        could lead to SQL injection if the variable is user-controlled and not properly sanitized.
        In order to prevent SQL injection, used parameterized queries or prepared statements
        instead.

         26â”† ->having(sprintf('(%s)', $havingQb->getSQL()).' = 0');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/EventListener/ReportDevicesSubscriber.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

        144â”† $clientInfo         = unserialize($row['client_info']);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Model/LeadModel.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        545â”† unlink($avatar);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Model/ListModel.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        916â”† $q->andWhere('ll.id IN ('.$segmentlist.')');
          â‹®â”†----------------------------------------
        919â”† $q->andWhere("l.date_added >= '".$dateFrom->format('Y-m-d')."'");
          â‹®â”†----------------------------------------
        922â”† $q->andWhere("l.date_added <= '".$dateTo->format('Y-m-d')." 23:59:59'");
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qAll` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        941â”† $qAll->andWhere("t.date_added >= '".$dateFrom->format('Y-m-d')."'");
          â‹®â”†----------------------------------------
        944â”† $qAll->andWhere("t.date_added <= '".$dateTo->format('Y-m-d')." 23:59:59'");


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Segment/Query/ContactSegmentQueryBuilder.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        128â”† $qb->select('DISTINCT '.$primary.' as leadIdPrimary');
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$queryBuilder->select('count(leadIdPrimary) count, max(leadIdPrimary) maxId,
        min(leadIdPrimary) minId')` Detected string concatenation with a non-literal variable in a
        Doctrine QueryBuilder method. This could lead to SQL injection if the variable is user-
        controlled and not properly sanitized. In order to prevent SQL injection, used parameterized
        queries or prepared statements instead.

        134â”† ->from('('.$qb->getSQL().')', 'sss');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Segment/Query/QueryBuilder.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        213â”† return $this->connection->executeQuery($this->getSQL(), $this->params, $this->paramTypes);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Tests/Functional/Controller/ImportControllerFunctionalTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         42â”† unlink($this->csvFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Tests/Model/ImportModelTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        393â”† @unlink(self::$csvPath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/LeadBundle/Tests/StandardImportTestHelper.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         43â”† unlink(self::$csvPath);
          â‹®â”†----------------------------------------
         47â”† unlink(self::$largeCsvPath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/NotificationBundle/Entity/NotificationRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'push_notifications')                 ->set($type.'_count',
        $type.'_count + '.(int) $increaseBy)` Detected string concatenation with a non-literal
        variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the variable
        is user-controlled and not properly sanitized. In order to prevent SQL injection, used
        parameterized queries or prepared statements instead.

        153â”† ->where('id = '.(int) $id);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/NotificationBundle/Entity/StatRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         94â”† $q->andWhere('s.list_id = '.(int) $listId);
          â‹®â”†----------------------------------------
        128â”† $q->andWhere('s.list_id = '.(int) $listId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'push_notification_stats')
        ->set('notification_id', (int) $toLeadId)` Detected string concatenation with a non-literal
        variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the variable
        is user-controlled and not properly sanitized. In order to prevent SQL injection, used
        parameterized queries or prepared statements instead.

        272â”† ->where('notification_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/NotificationBundle/EventListener/ReportSubscriber.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        216â”† $qb->leftJoin('pn', sprintf('(%s)', $qbcut->getSQL()), 'cut', 'pn.id = cut.channel_id');
          â‹®â”†----------------------------------------
        239â”† $qb->leftJoin('pn', sprintf('(%s)', $qbcut->getSQL()), 'cut', 'pn.id = cut.channel_id AND pns.lead_id = cut.lead_id');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/PageBundle/Entity/HitRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->select('u.is_unique')` Detected string concatenation with a non-literal variable in a
        Doctrine QueryBuilder method. This could lead to SQL injection if the variable is user-
        controlled and not properly sanitized. In order to prevent SQL injection, used parameterized
        queries or prepared statements instead.

         61â”† ->from(sprintf('(SELECT (NOT EXISTS (%s)) is_unique)', $q2->getSQL()), 'u');
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         82â”† $query->where('h.lead_id = '.(int) $leadId);
          â‹®â”†----------------------------------------
         86â”† $query->andWhere($query->expr()->like('p.title', $query->expr()->literal('%'.$options['search'].'%')));
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$sq` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        256â”† $sq->andWhere($sq->expr()->like('h.url', ':url_'.$k))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'page_hits')             ->set('date_left', ':datetime')`
        Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        484â”† ->where('id = '.(int) $lastHitId)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'page_hits')             ->set('lead_id', (int) $toLeadId)`
        Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        573â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/PageBundle/Entity/PageRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'pages')             ->set('hits', 'hits + '.(int)
        $increaseBy)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        254â”† ->where('id = '.(int) $id);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/PageBundle/Entity/RedirectRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'page_redirects')             ->set('hits', 'hits + '.(int)
        $increaseBy)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         73â”† ->where('id = '.(int) $id);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        143â”† sprintf('EXISTS (%s)', $sb->getSQL())
          â‹®â”†----------------------------------------
        162â”† sprintf('EXISTS (%s)', $sb->getSQL())


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/PageBundle/Entity/TrackableRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         26â”† return $q->select('r.redirect_id, r.url, r.id, '.$tableAlias.'.hits, '.$tableAlias.'.unique_hits')
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$subQ->select('distinct(list.lead_id)')
        ->from(MAUTIC_TABLE_PREFIX.'lead_lists_leads', 'list')` Detected string concatenation with a
        non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if
        the variable is user-controlled and not properly sanitized. In order to prevent SQL
        injection, used parameterized queries or prepared statements instead.

        183â”† $q->expr()->in('list.leadlist_id', array_map('intval', $listId))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        186â”† $q->innerJoin('ph', sprintf('(%s)', $subQ->getSQL()), 'cs', 'cs.lead_id = ph.lead_id');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/PageBundle/Entity/VideoHitRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         36â”† $query->expr()->like('h.url', $query->expr()->literal('%'.$options['search'].'%'))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'video_hits')             ->set('lead_id', (int) $toLeadId)`
        Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

        130â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/PointBundle/Entity/LeadPointLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'point_lead_action_log')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         35â”† ->where('lead_id = '.(int) $fromLeadId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->_em->getConnection()->createQueryBuilder()
        ->delete(MAUTIC_TABLE_PREFIX.'point_lead_action_log')` Detected string concatenation with a
        non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if
        the variable is user-controlled and not properly sanitized. In order to prevent SQL
        injection, used parameterized queries or prepared statements instead.

         45â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/PointBundle/Entity/LeadTriggerLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'point_lead_event_log')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         35â”† ->where('lead_id = '.(int) $fromLeadId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->_em->getConnection()->createQueryBuilder()
        ->delete(MAUTIC_TABLE_PREFIX.'point_lead_event_log')` Detected string concatenation with a
        non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if
        the variable is user-controlled and not properly sanitized. In order to prevent SQL
        injection, used parameterized queries or prepared statements instead.

         45â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/ReportBundle/Tests/Model/CsvExporterTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        132â”† unlink($tmpFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/ReportBundle/Tests/Model/ExcelExporterTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         61â”† unlink($tmpFile);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/ReportBundle/Tests/Scheduler/Model/FileHandlerTest.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         96â”† unlink($tmpFilePath);
          â‹®â”†----------------------------------------
         97â”† unlink($tmpZipFilePath);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/SmsBundle/Broadcast/BroadcastQuery.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        101â”† $this->query->andWhere(sprintf('NOT EXISTS (%s)', $statQb->getSQL()));
          â‹®â”†----------------------------------------
        116â”† $this->query->andWhere(sprintf('NOT EXISTS (%s)', $dncQb->getSQL()));
          â‹®â”†----------------------------------------
        132â”† $this->query->andWhere(sprintf('NOT EXISTS (%s)', $mqQb->getSQL()));


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/SmsBundle/Entity/SmsRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'sms_messages')                 ->set($type.'_count',
        $type.'_count + '.(int) $increaseBy)` Detected string concatenation with a non-literal
        variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the variable
        is user-controlled and not properly sanitized. In order to prevent SQL injection, used
        parameterized queries or prepared statements instead.

        197â”† ->where('id = '.(int) $id);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/SmsBundle/Entity/StatRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q` Detected string concatenation with a non-literal variable in a Doctrine QueryBuilder
        method. This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         95â”† $q->andWhere('s.list_id = '.(int) $listId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$query` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        151â”† $query->expr()->orX(
        152â”†     $query->expr()->like('e.name', $query->expr()->literal('%'.$options['search'].'%'))
        153â”† )
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'sms_message_stats')             ->set('sms_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        183â”† ->where('sms_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/StageBundle/Entity/LeadStageLogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$q->update(MAUTIC_TABLE_PREFIX.'stage_lead_action_log')             ->set('lead_id', (int)
        $toLeadId)` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

         35â”† ->where('lead_id = '.(int) $fromLeadId);
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$this->_em->getConnection()->createQueryBuilder()
        ->delete(MAUTIC_TABLE_PREFIX.'stage_lead_action_log')` Detected string concatenation with a
        non-literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if
        the variable is user-controlled and not properly sanitized. In order to prevent SQL
        injection, used parameterized queries or prepared statements instead.

         45â”† ->where('lead_id = '.(int) $fromLeadId)


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/UserBundle/Entity/User.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

        419â”† ) = unserialize($serialized);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/bundles/WebhookBundle/Entity/LogRepository.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-dbal-dangerous-query
        Detected string concatenation with a non-literal variable in a Doctrine DBAL query method.
        This could lead to SQL injection if the variable is user-controlled and not properly
        sanitized. In order to prevent SQL injection, used parameterized queries or prepared
        statements instead.

         96â”† while ($rows = $conn->executeQuery($sql, [$webHookId, $id], [ParameterType::INTEGER, ParameterType::INTEGER])->rowCount()) {
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb->select('count(id) as log_count')
        ->from(MAUTIC_TABLE_PREFIX.'webhook_logs', $this->getTableAlias())` Detected string
        concatenation with a non-literal variable in a Doctrine QueryBuilder method. This could lead
        to SQL injection if the variable is user-controlled and not properly sanitized. In order to
        prevent SQL injection, used parameterized queries or prepared statements instead.

         56â”† ->where('webhook_id = '.$webhookId)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb->select('id')                 ->from(MAUTIC_TABLE_PREFIX.'webhook_logs',
        $this->getTableAlias())` Detected string concatenation with a non-literal variable in a
        Doctrine QueryBuilder method. This could lead to SQL injection if the variable is user-
        controlled and not properly sanitized. In order to prevent SQL injection, used parameterized
        queries or prepared statements instead.

         64â”† ->where('webhook_id = '.$webhookId)
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$qb->delete(MAUTIC_TABLE_PREFIX.'webhook_logs')` Detected string concatenation with a non-
        literal variable in a Doctrine QueryBuilder method. This could lead to SQL injection if the
        variable is user-controlled and not properly sanitized. In order to prevent SQL injection,
        used parameterized queries or prepared statements instead.

         71â”† ->where($qb->expr()->in('id', $id))
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$countAllQb` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        131â”† $countAllQb->select('COUNT('.$this->getTableAlias().'.id) AS thecount')
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$countAllQb->select('COUNT('.$this->getTableAlias().'.id) AS thecount')` Detected string
        concatenation with a non-literal variable in a Doctrine QueryBuilder method. This could lead
        to SQL injection if the variable is user-controlled and not properly sanitized. In order to
        prevent SQL injection, used parameterized queries or prepared statements instead.

        132â”† ->from(sprintf('(%s)', $selectqb->getSQL()), $this->getTableAlias())
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$countSuccessQb` Detected string concatenation with a non-literal variable in a Doctrine
        QueryBuilder method. This could lead to SQL injection if the variable is user-controlled and
        not properly sanitized. In order to prevent SQL injection, used parameterized queries or
        prepared statements instead.

        145â”† $countSuccessQb->select('COUNT('.$this->getTableAlias().'.id) AS thecount')
          â‹®â”†----------------------------------------
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.doctrine-orm-dangerous-query
        `$countSuccessQb->select('COUNT('.$this->getTableAlias().'.id) AS thecount')` Detected
        string concatenation with a non-literal variable in a Doctrine QueryBuilder method. This
        could lead to SQL injection if the variable is user-controlled and not properly sanitized.
        In order to prevent SQL injection, used parameterized queries or prepared statements
        instead.

        146â”† ->from(sprintf('(%s)', $selectqb->getSQL()), $this->getTableAlias())


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/migrations/Version20190704154940.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

         39â”† @unlink($path.'/config.php');
          â‹®â”†----------------------------------------
         67â”† @unlink($path.'/config.json');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/app/migrations/Version20200422144300.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unserialize-use
        Calling `unserialize()` with user input in the pattern can lead to arbitrary code execution.
        Consider using JSON or structured data approaches (e.g. Google Protocol Buffers).

         81â”† $properties         = unserialize($rowToMigrate['properties']);
          â‹®â”†----------------------------------------
        114â”† $properties   = unserialize($rowToMigrate['properties']);


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/plugins/MauticCitrixBundle/Controller/PublicController.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.symfony-permissive-cors
        Access-Control-Allow-Origin response header is set to "*". This will disable CORS Same
        Origin Policy restrictions.

         70â”† $response->headers->set('Access-Control-Allow-Origin', '*');


  /home/rtz/github_vuln_research/my_semgrep_rules/custom_repos/repos_dir/mautic.mautic/upgrade.php 
     home.rtz.github_vuln_research.my_semgrep_rules.php_semgrep_rules.unlink-use
        Using user input when deleting files with `unlink()` is potentially dangerous. A malicious
        actor could use this to modify or access files they have no right to.

        923â”† @unlink($path);
          â‹®â”†----------------------------------------
        966â”† if (!@unlink($path)) {
          â‹®â”†----------------------------------------
        979â”† if (!@unlink($dirpath)) {
